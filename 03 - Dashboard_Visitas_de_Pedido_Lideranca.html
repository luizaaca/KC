<!DOCTYPE html>
<html>

<head>
    <title>Dashboard Visitas de Pedido</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=Edge' />

    <!--
		<link href="{path_js}/Style/style.css" rel="stylesheet" type="text/css" />
		<link href="{path_js}/Style/dash.css" rel="stylesheet" type="text/css" />
		<script src="{path_js}/js/amcharts.js" type="text/javascript"></script>
		<script src="{path_js}/js/pie.js" type="text/javascript"></script>
		<script src="{path_js}/js/serial.js" type="text/javascript"></script>
		<script src="{path_js}/js/MC1Lib.js" type="text/javascript"></script>
		<script src="{path_js}/js/gauge.js" type="text/javascript"></script>
		-->

    <link href="./Style/style.css" rel="stylesheet" type="text/css" />
    <link href="./Style/dash.css" rel="stylesheet" type="text/css" />
    <script src="./js/amcharts.js" type="text/javascript"></script>
    <script src="./js/pie.js" type="text/javascript"></script>
    <script src="./js/serial.js" type="text/javascript"></script>
    <script src="./js/MC1Lib.js" type="text/javascript"></script>
    <script src="./js/gauge.js" type="text/javascript"></script>

    <style>
        .th-head {
            background-color: #7D7D7D !important;
            color: #FFFFFF !important;
        }

        .tr-footer {
            background-color: #7D7D7D !important;
            text-transform: uppercase;
        }

        .td-footer {
            color: #FFFFFF !important;
            font-size: 14px !important;
        }

        .xpand {
            padding-right: 5px !important;
            white-space: nowrap;
            width: 10px;
            font-size: 18px !important;
            cursor: pointer;
        }

        .xpand-exec {
            padding-left: 0 !important;
            border-left: 0 !important;
        }

        .detail-cell {
            padding-left: 25px !important;
        }

        .hidden {
            display: none;
        }
    </style>
    </style>
    <!--
		<style> 
			#scrolly{
				width: 1000px;
				height: 190px;
				overflow: auto;
				overflow-y: hidden;
				margin: 0 auto;
				white-space: nowrap
			}
			
			.multiselect {
				width: 200px;
			}
			
			.selectBox {
				position: relative;
			}
			
			.selectBox select {
				width: 100%;
				font-weight: bold;
			}
			
			.overSelect {
				position: absolute;
				left: 0; right: 0; top: 0; bottom:0;
			}
			
			#checkboxes {
				display: none;
				border: 1px #dadada solid;
			}
			
			#checkboxes label {
				display: block;
			}
			
			#checkboxes label: hover {
				background-color: #le90ff;
			}
		</style>
		-->

    <script type="text/javascript">
        // <!--var ArrayDataProvider = [[mc1_l:WTM_META_DE_VENDA]];-->
        var perfil = 'gerente';

        var ArrayDataProviderChart = new Array(
            {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 30,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC",
                "qtde": 50,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 10,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 30,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 80,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 10,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC1",
                "qtde": 30,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 50,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 10,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 30,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 80,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 10,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }

        );
        var ArrayDataProviderChartTotalBrasil = new Array(
            {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 930,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC",
                "qtde": 850,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 910,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 630,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 580,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 810,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC1",
                "qtde": 830,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 950,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 1120,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 530,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 480,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 710,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }

        );
        var ArrayDataProviderChartCRN = new Array(
            {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 130,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC",
                "qtde": 80,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 120,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 130,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 180,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 210,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC1",
                "qtde": 130,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 150,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 210,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 130,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 180,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 110,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }

        );
        var ArrayDataProviderChartGerencia = new Array(
            {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 90,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC",
                "qtde": 90,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 110,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 70,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 88,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC2",
                "qtde": 101,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC1",
                "qtde": 130,
                "tipo": "Visitas de Pedido",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC1",
                "qtde": 53,
                "tipo": "Visitas de Pedido",
                "visita": "Não Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 102,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Sem Pedido",
                "customer": "KCC2",
                "qtde": 90,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 84,
                "tipo": "Visitas de Negociação",
                "visita": "Programada"
            }, {
                "pedido": "Com Pedido",
                "customer": "KCC",
                "qtde": 101,
                "tipo": "Visitas à Loja (DPSM)",
                "visita": "Não Programada"
            }

        );

        var ArrayDataProviderGrid = new Array(
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 83,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 81,
                "visita": "Não Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            }
        );
        var ArrayDataProviderGridTotalBrasil = new Array(
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            }
        );
        var ArrayDataProviderGridCRN = new Array(
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            }
        );
        var ArrayDataProviderGridGerencia = new Array(
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "Mimoto",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "Mimoto",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Pedido",
                "compedido": 81,
                "sempedido": 50,
                "visita": "Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 50,
                "sempedido": 40,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 15,
                "sempedido": 10,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas à Loja (DPSM)",
                "compedido": 30,
                "sempedido": 80,
                "visita": "Não Programada"
            },
            {
                "salesman": "João",
                "customer": "KCC",
                "tipo": "Visitas de Negociação",
                "compedido": 52,
                "sempedido": 77,
                "visita": "Não Programada"
            }, {
                "salesman": "João",
                "customer": "KCC1",
                "tipo": "Visitas de Negociação",
                "compedido": 22,
                "sempedido": 35,
                "visita": "Programada"
            }, {
                "salesman": "João",
                "customer": "KCC2",
                "tipo": "Visitas de Negociação",
                "compedido": 35,
                "sempedido": 55,
                "visita": "Programada"
            }
        );

        var selButtom = undefined;

        $(document).ready(function () {
            loadData(0);
            $("#filtro_tipo").on('change', function (event) {
                loadData(selButtom, $("#filtro_tipo").val(), $("#filtro_visita").val());
            });

            $("#filtro_visita").on('change', function (event) {
                loadData(selButtom, $("#filtro_tipo").val(), $("#filtro_visita").val());
            });

            $("a").click(function () {
                var selected = $(this).hasClass("selected");

                $("a." + $(this).attr("class").split(' ')[1]).removeClass("selected");
                $("a." + $(this).attr("class").split(' ')[1]).attr("style", "color: #867F79 !important").css("background", "EBEBEB");

                if (!selected) {
                    $(this).attr("style", "color:#fff !important").css("background", "#939FA2").css("text-decoration", "none");
                    $(this).addClass("selected");
                }
            });
        });

        function showDetail(salesman) {
            var detailClass = '.detail-' + salesman;

            if ($(detailClass).first().hasClass('hidden')) {
                $(this).text('-');
                $(detailClass).removeClass('hidden');
            } else {
                $(this).text('+');
                $(detailClass).addClass('hidden');
            }
        };

        var conditions = [undefined, "Todos"];
        function loadData(nivel, typeFilter, visitFilter) {
            if (nivel == selButtom && conditions.indexOf(typeFilter) >= 0 && conditions.indexOf(visitFilter) >= 0)
                nivel = 0;

            selButtom = nivel;
            var groupedData = undefined;
            var groupedDataGrid = undefined;

            if (perfil == "presidente") {
                $('#btn_totalbrasil').hide();
                $('#btn_crn').hide();
                $('#btn_gerencia').hide();
                nivel = 1;
            } else if (perfil == "crn") {
                $('#btn_crn').hide();
                $('#btn_gerencia').hide();
                if (nivel == 0)
                    nivel = 2;
            } else if (perfil == "gerente") {
                $('#btn_gerencia').hide();
                if (nivel == 0)
                    nivel = 3;
            }

            if (nivel == 1) {
                groupedData = ArrayDataProviderChartTotalBrasil;
                groupedDataGrid = ArrayDataProviderGridTotalBrasil;
            } else if (nivel == 2) {
                groupedData = ArrayDataProviderChartCRN;
                groupedDataGrid = ArrayDataProviderGridCRN;
            } else if (nivel == 3) {
                groupedData = ArrayDataProviderChartGerencia;
                groupedDataGrid = ArrayDataProviderGridGerencia;
            } else {
                groupedData = ArrayDataProviderChart;
                groupedDataGrid = ArrayDataProviderGrid;
            }

            if (conditions.indexOf(typeFilter) >= 0 && conditions.indexOf(visitFilter) >= 0) {
                buildFilterTipo(groupedData.map(function (i) { return i.tipo }).filter(function (value, index, self) { return self.indexOf(value) === index }));
                buildFilterVisita(groupedData.map(function (i) { return i.visita }).filter(function (value, index, self) { return self.indexOf(value) === index }));
            } else {
                if (typeFilter && typeFilter != "Todos") {
                    groupedData = groupedData.filter(function (i) { return i.tipo == typeFilter });
                    groupedDataGrid = groupedDataGrid.filter(function (i) { return i.tipo == typeFilter });
                }
                if (visitFilter && visitFilter != "Todos") {
                    groupedData = groupedData.filter(function (i) { return i.visita == visitFilter });
                    groupedDataGrid = groupedDataGrid.filter(function (i) { return i.visita == visitFilter });
                }
            }

            divLoadCharts(groupBy(groupedData, function (i) { return i.pedido }));
            divLoadGrid(groupedDataGrid, "griddiv");
        }

        function groupByToGrid(array, f) {
            var groups = {};
            array.forEach(function (o) {
                var group = f(o);

                if (!groups[group])
                    groups[group] = [];

                groups[group].push(o);
            });
            return Object.keys(groups).map(function (group) {
                var compedido = 0;
                var sempedido = 0;
                var customer = groups[group][0].customer;

                groups[group].forEach(function (value) {
                    compedido += value.compedido;
                    sempedido += value.sempedido;
                });
                return {
                    "customer": customer,
                    "compedido" : compedido,
                    "sempedido" : sempedido
                };
            });
        }

        function groupBy(array, f) {
            var groups = {};
            array.forEach(function (o) {
                var group = f(o);

                if (!groups[group])
                    groups[group] = [];

                groups[group].push(o);
            });
            return Object.keys(groups).map(function (group) {
                var qtde = 0;
                var pedido;

                groups[group].forEach(function (value) {
                    pedido = value.pedido;
                    qtde += value.qtde;
                });
                return {
                    "pedido":pedido,
                    "qtde": qtde
                };
            });
        }

        function detectmob() {
            if (window.innerWidth <= 200 && window.innerHeight <= 100) {
                return true;
            } else {
                return false;
            }
        }

        function buildFilterVisita(array) {
            var v_option = '';
            var v_count = 0;
            v_option += '<option value="Todos" selected>Visita</option>';

            for (var i = 0; i < array.length; i++) {
                v_option += '<option value="' + array[i] + '">' + array[i] + '</option>';
            }
            $('#filtro_visita').html(v_option);
        }

        function buildFilterTipo(array) {
            var v_option = '';
            var v_count = 0;

            v_option += '<option value="Todos" selected>Tipo</option>';

            for (var i = 0; i < array.length; i++) {
                v_option += '<option value="' + array[i] + '">' + array[i] + '</option>';
            }
            $("#filtro_tipo").html(v_option);
        }

        function divLoadCharts(array) {
            var ArrayDataFilter = array;

            AmCharts.makeChart("chartdiv",
                {
                    "type": "pie",
                    "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[qtde]]</b></span>",
                    "labelText": "[[title]]: [[qtde]]",
                    "minRadius": 0,
                    "pieX": "50%",
                    "pieY": "50%",
                    "radius": "0%",
                    "startAngle": 82.8,
                    "accessibleLabel": "[[title]]: [[qtde]] [[pedido]]",
                    "tabIndex": 3,
                    "titleField": "pedido",
                    "valueField": "qtde",
                    "allLabels": [],
                    "balloon": {},
                    "legend": {
                        "enabled": true,
                        "align": "center",
                        "markerType": "circle"
                    },
                    "titles": [],
                    "dataProvider": ArrayDataFilter
                }
            );
        }

        function validate() {
            for (var i = 0; i < document.getElementsByName("slt_username").length; i++) {
                alert(document.getElementsByName("slt_username")[i].checked + "-" + document.getElementsByName("slt_username")[i].value);
            }
        }

        var expanded = false;

        function showCheckboxes() {
            var checkboxes = document.getElementById("checkboxes");
            if (!expanded) {
                checkboxes.style.display = "block";
                expanded = true;
            } else {
                checkboxes.style.display = "none";
                expanded = false;
            }
        }
        function divLoadGrid(array, tbodyID) {
            var table = '';
            var total;
            var totalGeral = new Array(0, 0);

            var salesmans = array.map(function (item) { return item.salesman }).filter(function (value, index, self) {
                return self.indexOf(value) === index;
            }).sort();

            function compare(a, b) {
                if (a.customer < b.customer)
                    return -1;
                if (a.customer > b.customer)
                    return 1;
                return 0;
            }
            salesmans.forEach(function (salesman) {
                var group = '';
                var subTotal = new Array(0, 0);
                var arrayGroup = array.filter(function (item) { return item.salesman == salesman });
                $.each(groupByToGrid(arrayGroup, function (i) { return i.customer }).sort(compare), function (key, value) {
                    group += '<tr class="detail-' + salesman + ' hidden">';
                    $.each(value, function (key, value) {
                        var celcolor = '';

                        if (IsNumeric(value)) {
                            displayValue = formatNumber(value, 0);
                        } else {
                            displayValue = value;
                        }

                        if (key == 'customer') {
                            group += '<td class="detail-cell" colspan="2">' + displayValue + '</td>';
                        } else {
                            group += '<td' + celcolor + '>' + displayValue + '</td>';
                        }
                    });
                    group += '</tr>';

                    subTotal[0] += parseFloat(value['compedido']);
                    subTotal[1] += parseFloat(value['sempedido']);

                    totalGeral[0] += parseFloat(value['compedido']);
                    totalGeral[1] += parseFloat(value['sempedido']);
                });
                total = '<tr><td id="' + salesman + '" class="xpand" onclick="showDetail(\'' + salesman + '\')" >+</td><td class="xpand-exec"><strong>' + salesman + '</strong></td>';
                for (var i = 0; i < subTotal.length; i++) {
                    var celcolor = '';

                    if (i < 10 && subTotal[i] < 0)
                        celcolor = ' bgcolor="#ff0000"><font color="#fff"';

                    total += '<td' + celcolor + '><strong>' + formatNumber(subTotal[i], 0) + '</strong></td>';
                }
                total += '</tr>';
                table += total + group;
            });
            var finalRow = '<tr class="tr-footer"><td class="td-footer" colspan="2"><strong>Total Geral</strong></td>';
            for (var i = 0; i < totalGeral.length; i++) {
                var celcolor = '';

                if (totalGeral[i] < 0)
                    celcolor = ' bgcolor="#ff0000"';

                finalRow += '<td class="td-footer"' + celcolor + '><strong>' + formatNumber(totalGeral[i], 0) + '</strong></td>';
            }
            finalRow += '</tr>';
            table += finalRow;
            $('#' + tbodyID).html(table);
        }

        function formatNumber(num, fixed) {
            var decimalPart;
            var isNegative = false;
            var result;
            if (IsNumeric(num)) {
                if (num < 0) {
                    isNegative = true;
                    num = num * -1;
                }

                var array = num.toString().split('.');
                array = array[0].split('');

                var index = -3;
                while (array.length + index > 0) {
                    array.splice(index, 0, '.');
                    index -= 4;
                }

                if (fixed > 0) {
                    decimalPart = parseFloat(num).toFixed(fixed).split(".")[1];
                    result = array.join('') + "," + decimalPart;
                    if (isNegative) {
                        result = '-' + result;
                    }
                    return result;
                }
                result = array.join('');
                if (isNegative) {
                    result = '-' + result;
                }
                return result;
            }
            return num;
        };
    </script>
</head>

<body>
    <div id="container_filter" style="margin-left:0px;margin-right:20px;">
        <div class="one_wrap">
            <div class="widget" style="width: 100%;height:90px;">
                <div class="widget_title">
                    <span>Filtros</span>
                </div>
                <div class="vspace-25 wdt-vd" align="left" style="background-color: #FFFFFF; padding: 10px;">
                    <table>
                        <tr>
                            <td>
                                <select id="filtro_tipo" class="filtro_tipo" style="font-size:18px;"></select>
                                <select id="filtro_visita" class="filtro_visita" style="font-size:18px;"></select>
                            </td>
                            <td>
                                <div class="categ1">
                                    <a id="btn_totalbrasil" class="chang-bt nivel_btn" href="javascript:loadData(1)">Total Brasil</a>
                                    <a id="btn_crn" class="chang-bt nivel_btn" href="javascript:loadData(2)">CRN</a>
                                    <a id="btn_gerencia" class="chang-bt nivel_btn" href="javascript:loadData(3)">Gerência</a>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!--
			<div class="one_wrap" >
				<div class = "multiselect">
					<div class = "selectBox" onclick="showCheckboxes()">
						<select>
							<option> Select an option</option>
						</select>
						<div class="overSelect"></div>
					</div>
					<div id="checkboxes">
						<label for="one"><input type="checkbox" id="one"/>First checkbox</label>
						<label for="two"><input type="checkbox" id="two"/>Second checkbox</label>
						<label for="three"><input type="checkbox" id="three"/>Third checkbox</label>
					</div>
				</div>
				<button onclick="javascript:validate();">Validate</button>
			</div>
			-->
    </div>

    <div id="chartdiv" style="width: 100%; height: 400px; background-color: #FFFFFF;"></div>

    <div id="container_table" align="center">
        <div class="one_wrap" style="width: 100%">
            <div class="widget">
                <div class="widget_title_2">
                    <span>Tabela de Apoio</span>
                </div>
                <div class="datagrid" style="width: 100; overflow: auto;">
                    <table class="table_data">
                        <thead>
                            <tr>
                                <th bgcolor="#5d7b9d" colspan="2">
                                    <font color="#fff">Executivo</th>
                                <!--<td class="tg-us36">Executivo</td>-->
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Com Pedido</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Sem Pedido</th>

                                <!--<td class="tg-us36">Visitas Recomendadas</td>
						<td class="tg-us36">Visitas Planejadas</td>
						<td class="tg-us36">Visitas Realizadas</td>
						<td class="tg-us36">GAP</td>
						<td class="tg-us36">Visitas Recomendadas</td>
						<td class="tg-us36">Visitas Planejadas</td>
						<td class="tg-us36">Visitas Realizadas</td>
						<td class="tg-us36">GAP</td>-->
                            </tr>
                        </thead>
                        <!-- <thead>
                            <tr>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Executivo</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Recomendadas</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Planejadas</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Realizadas</th>	
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Recomendadas</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Planejadas</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">Visitas Realizadas</th>
                                <th bgcolor="#5d7b9d">
                                    <font color="#fff">GAP</th>
                            </tr>
						</thead>
						-->
                        <tbody id="griddiv" style="width: 100%; height: 100px; background-color: #FFFFFF; overflow: auto;"></tbody>
                    </table>
                </div>
                <div class="widget_legend">
                    <span></span>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

</html>